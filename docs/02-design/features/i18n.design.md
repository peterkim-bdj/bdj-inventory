# i18n (Internationalization) Design Document

> **Summary**: next-intl ê¸°ë°˜ ì˜ì–´(ê¸°ë³¸)/í•œêµ­ì–´ UI í…ìŠ¤íŠ¸ ë‹¤êµ­ì–´ ì¸í”„ë¼ì˜ ìƒì„¸ ê¸°ìˆ  ì„¤ê³„
>
> **Project**: BDJ Inventory
> **Author**: BDJ Team
> **Date**: 2026-02-06
> **Status**: Draft
> **Planning Doc**: [i18n.plan.md](../01-plan/features/i18n.plan.md)

---

## 1. Overview

### 1.1 Design Goals

- next-intlì„ ì‚¬ìš©í•˜ì—¬ Next.js App Routerì™€ ì™„ì „ í†µí•©ëœ i18n ì¸í”„ë¼ êµ¬ì¶•
- Server Components + Client Components ëª¨ë‘ì—ì„œ ë²ˆì—­ í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥
- ë²ˆì—­ í‚¤ì— ëŒ€í•œ TypeScript ìë™ì™„ì„± ì§€ì›
- Cookie ê¸°ë°˜ locale ì €ì¥ìœ¼ë¡œ URL ë³€ê²½ ì—†ì´ ì–¸ì–´ ì „í™˜
- ëª¨ë“  UI í…ìŠ¤íŠ¸ê°€ ë²ˆì—­ í‚¤ë¥¼ í†µí•´ ë Œë”ë§ë˜ëŠ” êµ¬ì¡° ê°•ì œ

### 1.2 Design Principles

- **No URL routing**: `/en/...`, `/ko/...` ê°™ì€ locale prefix ë¼ìš°íŒ… ì—†ìŒ (ë‚´ë¶€ ì‹œìŠ¤í…œ)
- **Cookie-based persistence**: ì„ íƒí•œ localeì„ cookieì— ì €ì¥, ì„œë²„ì—ì„œ ì½ì–´ SSR ì‹œ ì ìš©
- **English as source of truth**: en ë²ˆì—­ íŒŒì¼ì´ ê¸°ì¤€, koëŠ” enì˜ í‚¤ êµ¬ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ë”°ë¦„
- **Namespace isolation**: featureë³„ ë³„ë„ JSON íŒŒì¼ë¡œ ë²ˆì—­ ê´€ë¦¬
- **Gradual adoption**: ê³µí†µ(common) ë¨¼ì € êµ¬ì¶•, Phaseë³„ namespaceë¥¼ ì ì§„ì ìœ¼ë¡œ ì¶”ê°€

---

## 2. Architecture

### 2.1 Component Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Browser                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Next.js App                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚
â”‚  â”‚  â”‚ Server Components â”‚  â”‚ Client Components  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ useTranslations() â”‚  â”‚ useTranslations()  â”‚  â”‚    â”‚
â”‚  â”‚  â”‚ useFormatter()    â”‚  â”‚ useFormatter()     â”‚  â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚
â”‚  â”‚           â”‚                      â”‚               â”‚    â”‚
â”‚  â”‚           â–¼                      â–¼               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚  NextIntlClientProvider                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  (messages + locale passed from layout)   â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                         â–²                                â”‚
â”‚                         â”‚ locale from cookie             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Server (middleware.ts)  â”‚                                â”‚
â”‚  1. Read NEXT_LOCALE cookie                              â”‚
â”‚  2. Fallback: Accept-Language header                     â”‚
â”‚  3. Fallback: 'en' (default)                             â”‚
â”‚  4. Set resolved locale on request                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Translation Files       â”‚                                â”‚
â”‚  messages/en/*.json      â”‚                                â”‚
â”‚  messages/ko/*.json      â”‚                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Data Flow: Locale Resolution

```
[Request] â†’ middleware.ts
    â”‚
    â”œâ”€ Cookie "NEXT_LOCALE" exists? â†’ Use cookie value
    â”‚
    â”œâ”€ Accept-Language: ko? â†’ Use "ko"
    â”‚
    â””â”€ Default â†’ "en"
    â”‚
    â–¼
[i18n/request.ts] getRequestConfig()
    â”‚
    â”œâ”€ Load messages/{locale}/common.json
    â”œâ”€ Load messages/{locale}/shops.json (if exists)
    â”œâ”€ Load messages/{locale}/... (other namespaces)
    â”‚
    â–¼
[layout.tsx] NextIntlClientProvider
    â”‚
    â”œâ”€ Server Components: useTranslations() works directly
    â””â”€ Client Components: useTranslations() via Provider context
```

### 2.3 Data Flow: Language Switch

```
[User clicks Language Switcher]
    â”‚
    â–¼
[LanguageSwitcher component]
    â”‚
    â”œâ”€ Set cookie: NEXT_LOCALE = "ko" (or "en")
    â”œâ”€ router.refresh() â†’ triggers server re-render
    â”‚
    â–¼
[middleware.ts reads new cookie]
    â”‚
    â–¼
[Page re-renders with new locale messages]
```

### 2.4 Dependencies

| Component | Depends On | Purpose |
|-----------|-----------|---------|
| `middleware.ts` | `i18n/config.ts` | Locale resolution |
| `i18n/request.ts` | `messages/**/*.json` | Message loading |
| `layout.tsx` | `NextIntlClientProvider` | Provider setup |
| All UI components | `useTranslations` | Translation access |
| `LanguageSwitcher` | `useLocale`, `useRouter` | Locale switching |

---

## 3. File Structure

### 3.1 Complete File Tree

```
src/
â”œâ”€â”€ i18n/
â”‚   â”œâ”€â”€ config.ts                  # Locale constants and type definitions
â”‚   â””â”€â”€ request.ts                 # getRequestConfig for next-intl
â”œâ”€â”€ middleware.ts                   # Locale detection + cookie handling
â”œâ”€â”€ app/
â”‚   â””â”€â”€ layout.tsx                 # Root layout with NextIntlClientProvider
â”œâ”€â”€ components/
â”‚   â””â”€â”€ LanguageSwitcher.tsx       # Language toggle component
â””â”€â”€ messages/
    â”œâ”€â”€ en/
    â”‚   â””â”€â”€ common.json            # English translations (Sprint 0)
    â””â”€â”€ ko/
        â””â”€â”€ common.json            # Korean translations (Sprint 0)
```

### 3.2 File Details

#### `src/i18n/config.ts`

```typescript
export const locales = ['en', 'ko'] as const;
export type Locale = (typeof locales)[number];

export const defaultLocale: Locale = 'en';

export const localeNames: Record<Locale, string> = {
  en: 'English',
  ko: 'í•œêµ­ì–´',
};

// Cookie name for locale persistence
export const LOCALE_COOKIE = 'NEXT_LOCALE';
```

#### `src/i18n/request.ts`

```typescript
import { getRequestConfig } from 'next-intl/server';
import { cookies } from 'next/headers';
import { defaultLocale, locales, LOCALE_COOKIE, type Locale } from './config';

export default getRequestConfig(async () => {
  // 1. Read locale from cookie
  const cookieStore = await cookies();
  const cookieLocale = cookieStore.get(LOCALE_COOKIE)?.value;

  // 2. Validate and resolve locale
  let locale: Locale = defaultLocale;
  if (cookieLocale && locales.includes(cookieLocale as Locale)) {
    locale = cookieLocale as Locale;
  }

  // 3. Load all message files for the locale
  //    Dynamically import all available namespace files
  const namespaces = ['common'];

  // Optionally add feature-specific namespaces
  // These will be added as features are built
  const optionalNamespaces = [
    'shops', 'sync', 'products', 'vendors',
    'inventory', 'webhooks', 'workflows',
  ];

  const messages: Record<string, any> = {};

  // Load required namespaces
  for (const ns of namespaces) {
    messages[ns] = (await import(`@/messages/${locale}/${ns}.json`)).default;
  }

  // Load optional namespaces (skip if file doesn't exist)
  for (const ns of optionalNamespaces) {
    try {
      messages[ns] = (await import(`@/messages/${locale}/${ns}.json`)).default;
    } catch {
      // Namespace not yet created â€” skip silently
    }
  }

  return {
    locale,
    messages,
  };
});
```

#### `src/middleware.ts`

```typescript
import createMiddleware from 'next-intl/middleware';
import { NextRequest, NextResponse } from 'next/server';
import { defaultLocale, locales, LOCALE_COOKIE } from './i18n/config';

export function middleware(request: NextRequest) {
  const cookieLocale = request.cookies.get(LOCALE_COOKIE)?.value;

  // If no cookie, try Accept-Language header
  if (!cookieLocale) {
    const acceptLanguage = request.headers.get('Accept-Language') || '';
    const preferredLocale = acceptLanguage.includes('ko') ? 'ko' : defaultLocale;

    // Set cookie for future requests
    const response = NextResponse.next();
    response.cookies.set(LOCALE_COOKIE, preferredLocale, {
      path: '/',
      maxAge: 60 * 60 * 24 * 365, // 1 year
      sameSite: 'lax',
    });
    return response;
  }

  return NextResponse.next();
}

export const config = {
  // Match all routes except static files and API routes
  matcher: ['/((?!api|_next|.*\\..*).*)'],
};
```

#### `src/app/layout.tsx`

```typescript
import { NextIntlClientProvider } from 'next-intl';
import { getLocale, getMessages } from 'next-intl/server';

export default async function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  const locale = await getLocale();
  const messages = await getMessages();

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider locale={locale} messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

#### `src/components/LanguageSwitcher.tsx`

```typescript
'use client';

import { useLocale } from 'next-intl';
import { useRouter } from 'next/navigation';
import { locales, localeNames, LOCALE_COOKIE, type Locale } from '@/i18n/config';

export function LanguageSwitcher() {
  const locale = useLocale();
  const router = useRouter();

  function handleLocaleChange(newLocale: Locale) {
    // Set cookie
    document.cookie = `${LOCALE_COOKIE}=${newLocale};path=/;max-age=${60 * 60 * 24 * 365};samesite=lax`;
    // Trigger server re-render to pick up new locale
    router.refresh();
  }

  return (
    <div className="flex items-center gap-1">
      {locales.map((l) => (
        <button
          key={l}
          onClick={() => handleLocaleChange(l)}
          className={`px-2 py-1 text-sm rounded ${
            locale === l
              ? 'bg-primary text-primary-foreground font-medium'
              : 'text-muted-foreground hover:text-foreground'
          }`}
          disabled={locale === l}
        >
          {localeNames[l]}
        </button>
      ))}
    </div>
  );
}
```

---

## 4. Translation File Schema

### 4.1 Namespace: `common` (Initial)

Full JSON structure as defined in the Plan document.

**Key hierarchy**:
```
common
â”œâ”€â”€ nav.*           # Navigation menu items
â”œâ”€â”€ button.*        # Reusable button labels
â”œâ”€â”€ status.*        # Status indicators
â”œâ”€â”€ error.*         # Error messages
â”œâ”€â”€ table.*         # Table/pagination labels
â””â”€â”€ language.*      # Language switcher labels
```

### 4.2 Namespace: `shops` (Phase 0-1)

```json
// messages/en/shops.json
{
  "title": "Shop Management",
  "addShop": "Add Shop",
  "editShop": "Edit Shop",
  "deleteShop": "Delete Shop",
  "syncAll": "Sync All",
  "form": {
    "name": "Shop Name",
    "namePlaceholder": "e.g., Store A",
    "domain": "Shopify Domain",
    "domainPlaceholder": "store-a.myshopify.com",
    "accessToken": "Access Token",
    "accessTokenPlaceholder": "shpat_...",
    "apiVersion": "API Version"
  },
  "list": {
    "domain": "Domain",
    "productCount": "Products",
    "lastSynced": "Last Synced",
    "syncStatus": "Status",
    "actions": "Actions",
    "neverSynced": "â€”"
  },
  "status": {
    "never": "Never synced",
    "synced": "Synced",
    "inProgress": "Syncing...",
    "diffReview": "Diff Review Pending",
    "failed": "Sync Failed"
  },
  "delete": {
    "title": "Delete Shop",
    "confirm": "This will deactivate {count} products linked to this shop. Continue?",
    "success": "Shop deleted successfully"
  },
  "sync": {
    "start": "Sync",
    "startAll": "Sync All Shops",
    "initialComplete": "{productCount} products and {vendorCount} vendors imported",
    "inProgress": "Syncing {shopName}..."
  }
}
```

```json
// messages/ko/shops.json
{
  "title": "Shop ê´€ë¦¬",
  "addShop": "Shop ì¶”ê°€",
  "editShop": "Shop ìˆ˜ì •",
  "deleteShop": "Shop ì‚­ì œ",
  "syncAll": "ì „ì²´ ë™ê¸°í™”",
  "form": {
    "name": "Shop ì´ë¦„",
    "namePlaceholder": "ì˜ˆ: Store A",
    "domain": "Shopify ë„ë©”ì¸",
    "domainPlaceholder": "store-a.myshopify.com",
    "accessToken": "Access Token",
    "accessTokenPlaceholder": "shpat_...",
    "apiVersion": "API ë²„ì „"
  },
  "list": {
    "domain": "ë„ë©”ì¸",
    "productCount": "ìƒí’ˆ ìˆ˜",
    "lastSynced": "ë§ˆì§€ë§‰ ë™ê¸°í™”",
    "syncStatus": "ìƒíƒœ",
    "actions": "ì•¡ì…˜",
    "neverSynced": "â€”"
  },
  "status": {
    "never": "ë¯¸ë™ê¸°í™”",
    "synced": "ë™ê¸°í™” ì™„ë£Œ",
    "inProgress": "ë™ê¸°í™” ì¤‘...",
    "diffReview": "Diff í™•ì¸ ëŒ€ê¸°",
    "failed": "ë™ê¸°í™” ì‹¤íŒ¨"
  },
  "delete": {
    "title": "Shop ì‚­ì œ",
    "confirm": "ì´ ëª°ì— ì—°ê²°ëœ ìƒí’ˆ {count}ê°œë„ í•¨ê»˜ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?",
    "success": "Shopì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤"
  },
  "sync": {
    "start": "ë™ê¸°í™”",
    "startAll": "ì „ì²´ Shop ë™ê¸°í™”",
    "initialComplete": "ìƒí’ˆ {productCount}ê°œ, ë²¤ë” {vendorCount}ê°œ ì¶”ê°€ ì™„ë£Œ",
    "inProgress": "{shopName} ë™ê¸°í™” ì¤‘..."
  }
}
```

### 4.3 Namespace: `sync` (Phase 0-1)

```json
// messages/en/sync.json
{
  "diffReview": {
    "title": "{shopName} â€” Re-sync Results",
    "summary": {
      "new": "New",
      "modified": "Modified",
      "removed": "Removed",
      "unchanged": "Unchanged",
      "items": "{count} items"
    },
    "tabs": {
      "new": "New ({count})",
      "modified": "Modified ({count})",
      "removed": "Removed ({count})"
    },
    "actions": {
      "applySelected": "Apply Selected ({count})",
      "selectAll": "Select All",
      "deselectAll": "Deselect All"
    },
    "new": {
      "defaultAction": "Add",
      "ignore": "Ignore"
    },
    "modified": {
      "defaultAction": "Update to Shopify value",
      "keep": "Keep current"
    },
    "removed": {
      "defaultAction": "Keep (safe)",
      "deactivate": "Deactivate",
      "hint": "Default: Keep. Only deactivate if the Shopify deletion was intentional."
    },
    "field": {
      "changed": "changed",
      "price": "Price",
      "name": "Name",
      "imageUrl": "Image",
      "productType": "Product Type",
      "description": "Description"
    }
  },
  "log": {
    "title": "Sync History",
    "type": {
      "initial": "Initial",
      "resync": "Re-sync"
    },
    "status": {
      "fetching": "Fetching",
      "diffReview": "Diff Review",
      "applying": "Applying",
      "completed": "Completed",
      "failed": "Failed"
    },
    "detail": {
      "totalFetched": "Fetched",
      "applied": "Applied",
      "duration": "Duration"
    }
  }
}
```

```json
// messages/ko/sync.json
{
  "diffReview": {
    "title": "{shopName} â€” ì¬ë™ê¸°í™” ê²°ê³¼",
    "summary": {
      "new": "ì‹ ê·œ",
      "modified": "ë³€ê²½",
      "removed": "ì‚­ì œ",
      "unchanged": "ë™ì¼",
      "items": "{count}ê±´"
    },
    "tabs": {
      "new": "ì‹ ê·œ ({count})",
      "modified": "ë³€ê²½ ({count})",
      "removed": "ì‚­ì œ ({count})"
    },
    "actions": {
      "applySelected": "ì„ íƒ í•­ëª© ì ìš© ({count}ê±´)",
      "selectAll": "ì „ì²´ ì„ íƒ",
      "deselectAll": "ì „ì²´ í•´ì œ"
    },
    "new": {
      "defaultAction": "ì¶”ê°€",
      "ignore": "ë¬´ì‹œ"
    },
    "modified": {
      "defaultAction": "Shopify ê¸°ì¤€ ì—…ë°ì´íŠ¸",
      "keep": "ê¸°ì¡´ ìœ ì§€"
    },
    "removed": {
      "defaultAction": "ìœ ì§€ (ì•ˆì „)",
      "deactivate": "ë¹„í™œì„±í™”",
      "hint": "ê¸°ë³¸ê°’: ìœ ì§€. Shopifyì—ì„œì˜ ì‚­ì œê°€ ì˜ë„ì ì¸ ê²½ìš°ì—ë§Œ ë¹„í™œì„±í™”ë¥¼ ì„ íƒí•˜ì„¸ìš”."
    },
    "field": {
      "changed": "ë³€ê²½ë¨",
      "price": "ê°€ê²©",
      "name": "ìƒí’ˆëª…",
      "imageUrl": "ì´ë¯¸ì§€",
      "productType": "ìƒí’ˆ ìœ í˜•",
      "description": "ì„¤ëª…"
    }
  },
  "log": {
    "title": "ë™ê¸°í™” ì´ë ¥",
    "type": {
      "initial": "ì²« ë™ê¸°í™”",
      "resync": "ì¬ë™ê¸°í™”"
    },
    "status": {
      "fetching": "ë°ì´í„° ìˆ˜ì§‘ ì¤‘",
      "diffReview": "Diff í™•ì¸ ëŒ€ê¸°",
      "applying": "ë°˜ì˜ ì¤‘",
      "completed": "ì™„ë£Œ",
      "failed": "ì‹¤íŒ¨"
    },
    "detail": {
      "totalFetched": "ìˆ˜ì§‘ ìˆ˜",
      "applied": "ë°˜ì˜ ìˆ˜",
      "duration": "ì†Œìš” ì‹œê°„"
    }
  }
}
```

### 4.4 Namespace: `products` (Phase 0-1)

```json
// messages/en/products.json
{
  "title": "Products",
  "view": {
    "list": "List",
    "card": "Card"
  },
  "filter": {
    "store": "Store",
    "allStores": "All Stores",
    "vendor": "Vendor",
    "allVendors": "All Vendors",
    "productType": "Product Type",
    "allTypes": "All Types",
    "stockStatus": "Stock Status",
    "all": "All",
    "inStock": "In Stock",
    "outOfStock": "Out of Stock"
  },
  "sort": {
    "label": "Sort by",
    "nameAsc": "Name (A-Z)",
    "nameDesc": "Name (Z-A)",
    "priceLow": "Price (Low to High)",
    "priceHigh": "Price (High to Low)",
    "recentUpdate": "Recent Update",
    "vendor": "Vendor"
  },
  "search": {
    "placeholder": "Search by name, SKU, or barcode..."
  },
  "card": {
    "sku": "SKU",
    "vendor": "Vendor",
    "store": "Store",
    "price": "Price",
    "stock": "Stock",
    "noImage": "No image"
  },
  "group": {
    "title": "Product Groups",
    "mapped": "Mapped",
    "unmapped": "Unmapped",
    "stores": "{count} stores"
  }
}
```

```json
// messages/ko/products.json
{
  "title": "ìƒí’ˆ",
  "view": {
    "list": "ë¦¬ìŠ¤íŠ¸",
    "card": "ì¹´ë“œ"
  },
  "filter": {
    "store": "ì‡¼í•‘ëª°",
    "allStores": "ì „ì²´ ëª°",
    "vendor": "ë²¤ë”",
    "allVendors": "ì „ì²´ ë²¤ë”",
    "productType": "ìƒí’ˆ ìœ í˜•",
    "allTypes": "ì „ì²´ ìœ í˜•",
    "stockStatus": "ì¬ê³  ìƒíƒœ",
    "all": "ì „ì²´",
    "inStock": "ì¬ê³  ìˆìŒ",
    "outOfStock": "ì¬ê³  ì—†ìŒ"
  },
  "sort": {
    "label": "ì •ë ¬",
    "nameAsc": "ì´ë¦„ (A-Z)",
    "nameDesc": "ì´ë¦„ (Z-A)",
    "priceLow": "ê°€ê²© (ë‚®ì€ìˆœ)",
    "priceHigh": "ê°€ê²© (ë†’ì€ìˆœ)",
    "recentUpdate": "ìµœê·¼ ì—…ë°ì´íŠ¸",
    "vendor": "ë²¤ë”ëª…"
  },
  "search": {
    "placeholder": "ìƒí’ˆëª…, SKU ë˜ëŠ” ë°”ì½”ë“œë¡œ ê²€ìƒ‰..."
  },
  "card": {
    "sku": "SKU",
    "vendor": "ë²¤ë”",
    "store": "ëª°",
    "price": "ê°€ê²©",
    "stock": "ì¬ê³ ",
    "noImage": "ì´ë¯¸ì§€ ì—†ìŒ"
  },
  "group": {
    "title": "ìƒí’ˆ ê·¸ë£¹",
    "mapped": "ë§¤í•‘ë¨",
    "unmapped": "ë¯¸ë§¤í•‘",
    "stores": "{count}ê°œ ëª°"
  }
}
```

---

## 5. UI/UX Design

### 5.1 Language Switcher Placement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BDJ Inventory          [Dashboard] [Shops] [Products]â”‚
â”‚                                                       â”‚
â”‚                                    [EN | í•œêµ­ì–´]  [ğŸ‘¤] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â†‘
                              Language Switcher
                              (header right side)
```

### 5.2 Language Switcher States

```
Default (English active):
  [EN]  í•œêµ­ì–´

Korean active:
   EN  [í•œêµ­ì–´]

Active = filled button (bg-primary)
Inactive = text-only button (text-muted)
```

### 5.3 Component List

| Component | Location | Responsibility |
|-----------|----------|----------------|
| `LanguageSwitcher` | `src/components/LanguageSwitcher.tsx` | Locale toggle UI + cookie set + refresh |

---

## 6. Error Handling

### 6.1 Translation Errors

| Scenario | Behavior |
|----------|----------|
| Missing translation key | Fallback to English (next-intl default) |
| Missing translation file | Skip silently, use available namespaces |
| Invalid locale in cookie | Reset to default ('en') |
| Accept-Language not matching | Default to 'en' |

### 6.2 next-intl Error Config

```typescript
// In i18n/request.ts, next-intl handles missing keys:
// - Development: console warning
// - Production: renders English fallback
// No custom error handling needed â€” next-intl manages this natively
```

---

## 7. Usage Patterns

### 7.1 Server Component Usage

```typescript
import { useTranslations } from 'next-intl';

export default function ShopsPage() {
  const t = useTranslations('shops');
  const tCommon = useTranslations('common');

  return (
    <div>
      <h1>{t('title')}</h1>
      <button>{t('addShop')}</button>
      <p>{tCommon('status.loading')}</p>
    </div>
  );
}
```

### 7.2 Client Component Usage

```typescript
'use client';
import { useTranslations } from 'next-intl';

export function ShopForm() {
  const t = useTranslations('shops');

  return (
    <form>
      <label>{t('form.name')}</label>
      <input placeholder={t('form.namePlaceholder')} />
    </form>
  );
}
```

### 7.3 Interpolation

```typescript
// Translation key: "Applied {count} items"
t('sync.diffReview.actions.applySelected', { count: 14 });
// â†’ "Apply Selected (14)" / "ì„ íƒ í•­ëª© ì ìš© (14ê±´)"

// Translation key: "Syncing {shopName}..."
t('sync.inProgress', { shopName: 'Store A' });
// â†’ "Syncing Store A..." / "Store A ë™ê¸°í™” ì¤‘..."
```

### 7.4 Date/Number Formatting

```typescript
import { useFormatter } from 'next-intl';

function PriceDisplay({ price }: { price: number }) {
  const format = useFormatter();

  return (
    <span>
      {format.number(price, { style: 'currency', currency: 'KRW' })}
    </span>
  );
  // en: "â‚©45,000" / ko: "â‚©45,000" (same for KRW)
}

function DateDisplay({ date }: { date: Date }) {
  const format = useFormatter();

  return (
    <span>
      {format.dateTime(date, { dateStyle: 'medium', timeStyle: 'short' })}
    </span>
  );
  // en: "Feb 6, 2026, 2:30 PM" / ko: "2026. 2. 6. ì˜¤í›„ 2:30"
}

function RelativeTime({ date }: { date: Date }) {
  const format = useFormatter();

  return (
    <span>{format.relativeTime(date)}</span>
  );
  // en: "2 minutes ago" / ko: "2ë¶„ ì „"
}
```

---

## 8. Test Plan

### 8.1 Test Scope

| Type | Target | Tool |
|------|--------|------|
| Manual | Language switch, text rendering, persistence | Browser |
| Visual | Layout stability across locales | Browser resize |

### 8.2 Test Cases

- [ ] **Default locale**: Fresh visit â†’ English text renders
- [ ] **Auto-detect Korean**: Browser lang=ko â†’ Korean text renders
- [ ] **Switch to Korean**: Click í•œêµ­ì–´ â†’ all text switches to Korean
- [ ] **Switch back to English**: Click EN â†’ all text switches to English
- [ ] **Persistence**: Switch to Korean â†’ refresh â†’ still Korean
- [ ] **Interpolation**: Dynamic values ({count}, {shopName}) render correctly
- [ ] **Missing key fallback**: Remove a ko key â†’ English fallback renders
- [ ] **Date format**: en shows "Feb 6, 2026" / ko shows "2026. 2. 6."
- [ ] **Number format**: Currency â‚©45,000 renders correctly in both
- [ ] **Layout stability**: No layout shift when switching locale
- [ ] **All common keys**: Every key in common.json renders in both locales

---

## 9. next-intl Configuration

### 9.1 `next.config.ts`

```typescript
import createNextIntlPlugin from 'next-intl/plugin';

const withNextIntl = createNextIntlPlugin('./src/i18n/request.ts');

const nextConfig = {
  // ... other config
};

export default withNextIntl(nextConfig);
```

### 9.2 `tsconfig.json` path alias

```json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"],
      "@/messages/*": ["./src/messages/*"]
    }
  }
}
```

---

## 10. Implementation Order

### Step 1: Install & Configure (Infrastructure)

1. [ ] `npm install next-intl`
2. [ ] Create `src/i18n/config.ts`
3. [ ] Create `src/i18n/request.ts`
4. [ ] Update `next.config.ts` with `createNextIntlPlugin`
5. [ ] Create `src/middleware.ts`

### Step 2: Translation Files

6. [ ] Create `src/messages/en/common.json`
7. [ ] Create `src/messages/ko/common.json`

### Step 3: App Integration

8. [ ] Update `src/app/layout.tsx` with `NextIntlClientProvider`
9. [ ] Create `src/components/LanguageSwitcher.tsx`
10. [ ] Add LanguageSwitcher to app header/layout

### Step 4: Verify

11. [ ] Verify en/ko switch works
12. [ ] Verify cookie persistence
13. [ ] Verify date/number formatting
14. [ ] Verify missing key fallback

### Step 5: Phase 0-1 Translation Files (alongside Phase 0-1 development)

15. [ ] Create `src/messages/en/shops.json` + `ko/shops.json`
16. [ ] Create `src/messages/en/sync.json` + `ko/sync.json`
17. [ ] Create `src/messages/en/products.json` + `ko/products.json`

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 0.1 | 2026-02-06 | Initial design from Plan | BDJ Team |
