# i18n (Internationalization) Planning Document

> **Summary**: English(default)/Korean UI text internationalization using next-intl, applied from the start across all Phases.
>
> **Project**: BDJ Inventory
> **Author**: BDJ Team
> **Date**: 2026-02-06
> **Status**: Draft

---

## 1. Overview

### 1.1 Purpose

BDJ Inventory 시스템의 모든 UI 텍스트를 영어(기본)/한국어로 전환할 수 있도록 다국어 인프라를 처음부터 구축한다. 하드코딩된 문자열 없이 번역 키 기반으로 텍스트를 관리하여, 향후 언어 추가도 용이하게 한다.

### 1.2 Background

- BDJ Inventory는 한국 기반이지만, 영어가 기본 언어로 필요
- 모든 Phase(0-1 ~ 2)의 UI가 이 i18n 인프라 위에 구축됨
- 나중에 i18n을 도입하면 전체 UI를 리팩토링해야 하므로, 처음부터 적용이 효율적
- DB 데이터(상품명 등)는 Shopify 원본 그대로 사용하므로 번역 대상이 아님

### 1.3 Related Documents

- [Phase0-1 Plan](./Phase0-1.plan.md)
- [Schema Reference](../../Schema%20Reference%20-%20BDJ%20Inventory.md)

---

## 2. Scope

### 2.1 In Scope

- [ ] next-intl 라이브러리 설정 (Next.js App Router)
- [ ] 영어(en) / 한국어(ko) 번역 파일 구조 설계
- [ ] Locale 감지 + 전환 UI (Language Switcher)
- [ ] 브라우저 언어 기반 자동 감지 (초기 접속 시)
- [ ] 번역 키 네이밍 컨벤션 정의
- [ ] 공통 UI 텍스트 번역 (네비게이션, 버튼, 에러 메시지 등)
- [ ] 날짜/숫자/통화 포맷팅 (locale별)
- [ ] Phase 0-1 UI 텍스트 번역 적용

### 2.2 Out of Scope

- DB 데이터 다국어 저장 (상품명, 설명 등은 Shopify 원본 그대로)
- URL 기반 locale 라우팅 (`/en/shops`, `/ko/shops`) — 현재 불필요
- SEO용 hreflang 태그 — 내부 시스템이므로 불필요
- 3개 이상 언어 지원 — 향후 확장 가능하도록 구조만 준비

---

## 3. Requirements

### 3.1 Functional Requirements

| ID | Requirement | Priority | Status |
|----|-------------|----------|--------|
| FR-01 | 영어(en)를 기본 언어로 설정 | High | Pending |
| FR-02 | 한국어(ko) 번역 전환 지원 | High | Pending |
| FR-03 | Language Switcher UI (헤더/사이드바) | High | Pending |
| FR-04 | 브라우저 Accept-Language 기반 자동 감지 | Medium | Pending |
| FR-05 | 선택한 언어를 localStorage/cookie에 저장 | High | Pending |
| FR-06 | 날짜 포맷: en(Feb 6, 2026) / ko(2026년 2월 6일) | Medium | Pending |
| FR-07 | 숫자/통화 포맷: en($45,000) / ko(₩45,000) | Medium | Pending |
| FR-08 | 번역 누락 시 fallback to English | High | Pending |
| FR-09 | 공통 텍스트 번역 (nav, buttons, errors, form labels) | High | Pending |
| FR-10 | Phase 0-1 전용 텍스트 번역 (Shop, Sync, Product 관련) | High | Pending |

### 3.2 Non-Functional Requirements

| Category | Criteria | Measurement Method |
|----------|----------|-------------------|
| Performance | 번역 파일 로딩이 초기 렌더링에 영향 없음 | LCP 측정 |
| DX | 새 번역 키 추가 시 타입 안전 (autocomplete) | TypeScript 검증 |
| Maintainability | 번역 파일 구조가 feature별로 분리 | 코드 리뷰 |

---

## 4. Success Criteria

### 4.1 Definition of Done

- [ ] 모든 UI 텍스트가 번역 키를 통해 렌더링 (하드코딩 문자열 0개)
- [ ] Language Switcher로 en/ko 실시간 전환 가능
- [ ] 새로고침 후에도 선택한 언어 유지
- [ ] 번역 누락 키는 영어 fallback 정상 동작
- [ ] Phase 0-1 전체 UI에 i18n 적용 완료

### 4.2 Quality Criteria

- [ ] TypeScript 기반 번역 키 자동완성
- [ ] 빌드 시 번역 누락 경고
- [ ] Zero layout shift on locale change

---

## 5. Risks and Mitigation

| Risk | Impact | Likelihood | Mitigation |
|------|--------|------------|------------|
| 번역 키 누락으로 빈 텍스트 노출 | Medium | Medium | fallback to English + 개발 시 lint 경고 |
| 번역 파일 비대화 | Low | Medium | feature별 namespace 분리 + lazy loading |
| 한/영 텍스트 길이 차이로 레이아웃 깨짐 | Medium | Medium | Tailwind responsive + min-width 설정 |
| 팀원이 번역 키 대신 하드코딩 문자열 사용 | Medium | High | ESLint rule (no-literal-string) + PR 리뷰 체크 |

---

## 6. Architecture Considerations

### 6.1 Library Selection

| Library | App Router | Type Safety | Bundle Size | Selected |
|---------|-----------|-------------|-------------|:--------:|
| **next-intl** | Native support | Excellent (TypeScript) | ~15KB | **v** |
| next-i18next | Pages Router focused | Good | ~20KB | |
| react-i18next | Manual setup needed | Good | ~25KB | |
| Custom (React Context) | Any | Manual | 0KB | |

**Rationale**: `next-intl`은 Next.js App Router와 네이티브 통합, Server Components 지원, TypeScript 자동완성이 우수하다.

### 6.2 Translation File Structure

```
messages/
├── en/
│   ├── common.json          # 공통 (nav, buttons, errors, form labels)
│   ├── shops.json            # Phase 0-1: Shop 관리
│   ├── sync.json             # Phase 0-1: Sync & Diff Review
│   ├── products.json         # Phase 0-1: Product View
│   ├── vendors.json          # Phase 0-3: Vendor 관리
│   ├── inventory.json        # Phase 0-2: Inventory 등록
│   ├── webhooks.json         # Phase 1: Webhook 모니터링
│   └── workflows.json        # Phase 2: Workflow 대시보드
└── ko/
    ├── common.json
    ├── shops.json
    ├── sync.json
    ├── products.json
    ├── vendors.json
    ├── inventory.json
    ├── webhooks.json
    └── workflows.json
```

### 6.3 Translation Key Convention

```
{namespace}.{section}.{element}

Examples:
  common.nav.dashboard          → "Dashboard" / "대시보드"
  common.button.save            → "Save" / "저장"
  common.button.cancel          → "Cancel" / "취소"
  common.error.required         → "This field is required" / "필수 항목입니다"
  common.error.networkError     → "Network error occurred" / "네트워크 오류가 발생했습니다"

  shops.title                   → "Shop Management" / "Shop 관리"
  shops.addShop                 → "Add Shop" / "Shop 추가"
  shops.form.name               → "Shop Name" / "Shop 이름"
  shops.form.domain             → "Shopify Domain" / "Shopify 도메인"
  shops.status.synced           → "Synced" / "동기화 완료"
  shops.status.never            → "Never synced" / "미동기화"

  sync.diffReview.title         → "Re-sync Results" / "재동기화 결과"
  sync.diffReview.new           → "New" / "신규"
  sync.diffReview.modified      → "Modified" / "변경"
  sync.diffReview.removed       → "Removed" / "삭제"
  sync.diffReview.applySelected → "Apply Selected ({count})" / "선택 항목 적용 ({count}건)"

  products.filter.allStores     → "All Stores" / "전체 몰"
  products.filter.inStock       → "In Stock" / "재고 있음"
  products.sort.recentUpdate    → "Recent Update" / "최근 업데이트"
```

### 6.4 Integration Pattern

```typescript
// Server Component
import { useTranslations } from 'next-intl';

export default function ShopList() {
  const t = useTranslations('shops');

  return (
    <div>
      <h1>{t('title')}</h1>
      <Button>{t('addShop')}</Button>
    </div>
  );
}

// With interpolation
t('sync.diffReview.applySelected', { count: 14 })
// → "Apply Selected (14)" / "선택 항목 적용 (14건)"

// Date/Number formatting
import { useFormatter } from 'next-intl';
const format = useFormatter();
format.dateTime(date, { dateStyle: 'medium' });
// → "Feb 6, 2026" / "2026년 2월 6일"
format.number(45000, { style: 'currency', currency: 'KRW' });
// → "₩45,000"
```

### 6.5 Locale Detection & Persistence

```
1. Cookie (locale) 확인 → 있으면 해당 locale 사용
2. 없으면 → Accept-Language 헤더 감지
3. 감지 불가 → English fallback
4. 사용자가 Language Switcher로 변경 → Cookie 저장
```

### 6.6 next-intl Setup (App Router)

```
src/
├── i18n/
│   ├── config.ts              # Supported locales, default locale
│   ├── request.ts             # getRequestConfig for next-intl
│   └── navigation.ts          # Locale-aware navigation helpers
├── messages/                   # Translation files (위 구조 참고)
└── middleware.ts               # Locale detection middleware
```

---

## 7. Convention Prerequisites

### 7.1 i18n Coding Conventions

| Rule | Description |
|------|-------------|
| **No hardcoded strings** | 모든 사용자 표시 텍스트는 `t()` 함수 사용 |
| **Namespace per feature** | 각 feature별 별도 JSON 파일 |
| **Key naming** | `{namespace}.{section}.{element}` 패턴 |
| **Pluralization** | `t('items', { count })` + `one`/`other` 키 |
| **Interpolation** | `{variable}` 형식으로 동적 값 삽입 |
| **English first** | en 번역을 먼저 작성하고 ko 번역 추가 |

### 7.2 Dependencies

| Package | Purpose | Version |
|---------|---------|---------|
| `next-intl` | i18n core | latest |

---

## 8. Implementation Order

### Sprint 0: i18n Infrastructure (Day 1)

1. [ ] `next-intl` 설치 및 Next.js App Router 설정
2. [ ] `i18n/config.ts` — supported locales, default locale 정의
3. [ ] `i18n/request.ts` — getRequestConfig 설정
4. [ ] `middleware.ts` — locale detection middleware
5. [ ] `messages/en/common.json` — 공통 번역 키 초기 세트
6. [ ] `messages/ko/common.json` — 한국어 번역
7. [ ] Language Switcher 컴포넌트 구현
8. [ ] 날짜/숫자/통화 포맷팅 설정 확인

### Ongoing: Phase별 번역 파일 추가

- Phase 0-1 구현 시: `shops.json`, `sync.json`, `products.json` 추가
- Phase 0-2 구현 시: `inventory.json` 추가
- Phase 0-3 구현 시: `vendors.json` 추가
- Phase 1 구현 시: `webhooks.json` 추가
- Phase 2 구현 시: `workflows.json` 추가

---

## 9. Sample Translation Files

### messages/en/common.json

```json
{
  "nav": {
    "dashboard": "Dashboard",
    "shops": "Shops",
    "products": "Products",
    "inventory": "Inventory",
    "vendors": "Vendors",
    "webhooks": "Webhooks",
    "workflows": "Workflows",
    "settings": "Settings"
  },
  "button": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "add": "Add",
    "search": "Search",
    "filter": "Filter",
    "reset": "Reset",
    "apply": "Apply",
    "confirm": "Confirm",
    "back": "Back",
    "next": "Next",
    "selectAll": "Select All",
    "deselectAll": "Deselect All",
    "export": "Export",
    "import": "Import"
  },
  "status": {
    "active": "Active",
    "inactive": "Inactive",
    "loading": "Loading...",
    "saving": "Saving...",
    "success": "Success",
    "error": "Error",
    "noData": "No data found",
    "noResults": "No results found"
  },
  "error": {
    "required": "This field is required",
    "invalidEmail": "Invalid email address",
    "networkError": "A network error occurred. Please try again.",
    "serverError": "Server error. Please try again later.",
    "notFound": "Not found",
    "unauthorized": "Unauthorized access",
    "confirmDelete": "Are you sure you want to delete this? This action cannot be undone."
  },
  "table": {
    "actions": "Actions",
    "showing": "Showing {from}-{to} of {total}",
    "rowsPerPage": "Rows per page",
    "noData": "No data"
  },
  "language": {
    "en": "English",
    "ko": "한국어",
    "switchLanguage": "Language"
  }
}
```

### messages/ko/common.json

```json
{
  "nav": {
    "dashboard": "대시보드",
    "shops": "Shop 관리",
    "products": "상품",
    "inventory": "재고",
    "vendors": "벤더",
    "webhooks": "웹훅",
    "workflows": "워크플로우",
    "settings": "설정"
  },
  "button": {
    "save": "저장",
    "cancel": "취소",
    "delete": "삭제",
    "edit": "수정",
    "add": "추가",
    "search": "검색",
    "filter": "필터",
    "reset": "초기화",
    "apply": "적용",
    "confirm": "확인",
    "back": "뒤로",
    "next": "다음",
    "selectAll": "전체 선택",
    "deselectAll": "전체 해제",
    "export": "내보내기",
    "import": "가져오기"
  },
  "status": {
    "active": "활성",
    "inactive": "비활성",
    "loading": "로딩 중...",
    "saving": "저장 중...",
    "success": "성공",
    "error": "오류",
    "noData": "데이터가 없습니다",
    "noResults": "검색 결과가 없습니다"
  },
  "error": {
    "required": "필수 항목입니다",
    "invalidEmail": "유효하지 않은 이메일 주소입니다",
    "networkError": "네트워크 오류가 발생했습니다. 다시 시도해 주세요.",
    "serverError": "서버 오류가 발생했습니다. 잠시 후 다시 시도해 주세요.",
    "notFound": "찾을 수 없습니다",
    "unauthorized": "접근 권한이 없습니다",
    "confirmDelete": "정말 삭제하시겠습니까? 이 작업은 되돌릴 수 없습니다."
  },
  "table": {
    "actions": "액션",
    "showing": "{total}개 중 {from}-{to}",
    "rowsPerPage": "페이지당 행 수",
    "noData": "데이터 없음"
  },
  "language": {
    "en": "English",
    "ko": "한국어",
    "switchLanguage": "언어"
  }
}
```

---

## 10. Next Steps

1. [ ] Write design document (`i18n.design.md`)
2. [ ] Implement i18n infrastructure (Sprint 0) **before** Phase 0-1 UI
3. [ ] Phase 0-1 UI 구현 시 i18n 적용하며 번역 파일 동시 작성

---

## Version History

| Version | Date | Changes | Author |
|---------|------|---------|--------|
| 0.1 | 2026-02-06 | Initial draft | BDJ Team |
